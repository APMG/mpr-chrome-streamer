if("undefined"===typeof APMPlayerFactory)var APMPlayerFactory=function(){var d={type:{AUDIO:"audio",LIVE_AUDIO:"live_audio"},isValid:function(a){for(var b in d.type)if(d.type[b]===a)return!0;return!1}},b=function(){};b.enabled=!1;b.consoleOnly=!0;b.log=function(a,e,f){if(!1!==b.enabled){"undefined"===typeof f&&(f="APMPlayer");var d=!1;"undefined"!==typeof soundManager&&(d=soundManager._writeDebug(f+"::"+a,e.id,!1));"undefined"!==typeof soundManager&&d||console.log(f+"::"+a+"["+e.name+"]")}};b.type=
{info:{id:1,name:"info"},warn:{id:2,name:"warning"},error:{id:3,name:"error"}};var h=function(){this.type={AUDIO_LIB_READY:"AUDIO_LIB_READY",MEDIA_READY:"MEDIA_READY",PLAYER_READY:"PLAYER_READY",PLAYER_FAILURE:"PLAYER_FAILURE",CONNECTION_LOST:"CONNECTION_LOST",MISSING_FILE:"MISSING_FILE",PLAYLIST_CURRENT_CHANGE:"PLAYLIST_CURRENT_CHANGE",POSITION_UPDATE:"POSITION_UPDATE",PLAYING:"PLAYING",PAUSED:"PAUSED",FINISHED:"FINISHED",UNLOADED:"UNLOADED",BUFFER_START:"BUFFER_START",BUFFER_END:"BUFFER_END",METADATA:"METADATA",
VOLUME_UPDATED:"VOLUME_UPDATED"};this.handlers=[]};h.prototype={trigger:function(a,b){var f;for(f=0;f<this.handlers.length;f+=1)this.handlers[f].eventName===a&&this.handlers[f].eventHandler.call(this,b)},addListener:function(a,e){"string"===typeof a&&"function"===typeof e||b.log("Invalid parameters when creating listener with the following arguments: 'Name': "+a+", 'Handler': "+e,b.type.error);this.handlers.push({eventName:a,eventHandler:e})},removeListeners:function(){this.handlers=[]}};var l=function(){this.type=
{PLAYING:"PLAYING",STOPPED:"STOPPED",PAUSED:"PAUSED"};this._current=this.type.STOPPED};l.prototype={current:function(){return this._current},set:function(a,b){this._current=a;"object"===typeof b&&b.hasOwnProperty("state")&&(b.state=this._current)}};var a=function(){this.type={FLASH:"FLASH",HTML5:"HTML5"};this.solutions=[this.type.FLASH,this.type.HTML5]};a.prototype={getCurrentSolution:function(){return 0<this.solutions.length?this.solutions[0]:null},removeCurrentSolution:function(){if(0<this.solutions.length)return this.solutions.shift(),
!0;b.log("PlaybackMechanism.removeCurrentSolution() no playback solutions remain to remove!",b.type.error);return!1},setSolutions:function(a){if(a instanceof Array){for(var e=[],f;0<a.length;)f=a.shift(),this.isValid(f)?e.push(f):b.log("PlaybackMechanism.setSolutions() passed mechanism '"+f+"' is invalid.",b.type.error);this.solutions=e;return!0}b.log("PlaybackMechanism.setSolutions() argument passed is not an array!",b.type.error);return!1},isValid:function(a){for(var b in this.type)if(this.type[b]===
a)return!0;return!1}};var e=function(){this.schemes=[];this.scheme_map={};this.playable_attrs=[]};e.prototype={init:function(a){this.scheme_map=a;this.initSchemeTypes();this.initPlayableAttrs()},initSchemeTypes:function(){this.schemes=[];for(var a in this.scheme_map)this.schemes.push(a)},initPlayableAttrs:function(){this.playable_attrs=[];var a=new k({}),b;for(b in a)"function"!==typeof a[b]&&this.playable_attrs.push(b)},hasSchemes:function(){return 0<this.schemes.length?!0:!1},isValid:function(a){return-1!==
this.schemes.indexOf(a)?!0:!1},isScheme:function(a,b){var f=this.parse(a);return null!==f&&f.scheme===b?!0:!1},parse:function(a){var b="^("+this.schemes.join("|")+"){1}(:/){1}([/\\w.-]+$)";a=a.match(RegExp(b));return null!==a&&4===a.length?{scheme:a[1],path:a[3]}:null},getValues:function(a){var b={};a=this.parse(a);if(null!==a&&this.isValid(a.scheme)){var f=this.scheme_map[a.scheme];f.hasOwnProperty(a.path)&&(f=f[a.path]);for(var e in f)-1!==this.playable_attrs.indexOf(e)?b[e]=f[e]:"flash_file_prefix"===
e?b.flash_file_path=f[e]+"/"+a.path:"http_file_prefix"===e&&(b.http_file_path=f[e]+"/"+a.path)}return b}};var g=new e,k=function(a){this.type=this.identifier=null;this.http_file_path=this.flash_server_url=this.flash_file_path="";this.buffer_time=3;this.downloadable=!0;this.image_lg=this.image_sm=this.url=this.host=this.program=this.date=this.detail=this.description=this.title="";this.percent_loaded=this.percent_played=this.position=this.duration=0;this.state="STOPPED";if("undefined"===typeof a.identifier||
null===a.identifier||""===a.identifier)return this;this.setMembers(a);g.hasSchemes()&&(a=g.getValues(this.identifier),this.setMembers(a));return this};k.prototype={isValid:function(){return null!==this.identifier&&null!==this.type&&d.isValid(this.type)?!0:!1},isCustomScheme:function(a){return!0===g.isScheme(this.identifier,a)?!0:!1},isEOF:function(){return 0.99995<this.percent_played?!0:!1},reset:function(){this.percent_loaded=this.percent_played=this.position=0},setEmptyMembers:function(a){for(var b in a)a.hasOwnProperty(b)&&
this.hasOwnProperty(b)&&null!==a[b]&&""!==a[b]&&(null===this[b]||""===this[b]||0===this[b])&&(this[b]=a[b])},setMembers:function(a){for(var b in a)a.hasOwnProperty(b)&&this.hasOwnProperty(b)&&(this[b]=a[b])},clearFlashProperties:function(){this.flash_file_path=this.flash_server_url=""},isFlashStreamable:function(){return""!==this.flash_server_url&&""!==this.flash_file_path?!0:!1}};var n=function(a){this.click_url=null;this.has_played=!1;this.is_underwriting=!0;k.apply(this,arguments)};n.prototype=
k.prototype;var q=function(){var c=this,e=function(){this.lib=soundManager;this.init_status=!1};e.prototype={init:function(a){if(!1===c.audio.init_status){a=$.extend({preferFlash:!0,swf:!1},a);var e=/7.0 Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);this.lib.flashVersion=9;e&&a.preferFlash?(this.lib.preferFlash=!1,b.log("Audio.init() -- setting to HTML5-only due to Safari 7.",b.type.info)):(this.lib.preferFlash=a.preferFlash)?b.log("Audio.init() -- Preferring Flash.",
b.type.info):b.log("Audio.init() -- Preferring HTML5.",b.type.info);this.lib.useHTML5Audio=!0;this.lib.consoleOnly=b.consoleOnly;this.lib.debugMode=b.enabled;this.lib.flashPollingInterval=150;!1!==a.swf?(this.lib.url=a.swf,b.log("Audio.init() -- Soundmanager script path manually set: "+a.swf,b.type.info)):(this.lib.url=c.util.getLoadedScriptPathByFileName("soundmanager2")+"swf/",void 0===this.lib.url&&b.log("Audio.init() -- Soundmanager script path isn't found. You are probably concatenating SM2 without defining the swf location.",
b.type.error));this.lib.onready(function(){!0===c.audio.lib.html5Only&&(c.mechanism.setSolutions([c.mechanism.type.HTML5]),b.log("Audio.init() -- setting to HTML5-only",b.type.info));b.log("Audio.init() success",b.type.info);c.audio.init_status=!0;c.internal_events.trigger(c.events.type.AUDIO_LIB_READY,{})});this.lib.ontimeout(function(a){c.audio.lib.canPlayMIME("audio/mp3")||c.audio.lib.canPlayMIME("audio/mpeg")?c.mechanism.setSolutions([c.mechanism.type.HTML5]):c.mechanism.setSolutions([]);c.audio.reset()})}else c.audio.reset(),
b.log("Audio.init() -- audio lib has already been initialized once, attempting reset",b.type.info)},reset:function(){c.audio.init_status=!1;switch(c.mechanism.getCurrentSolution()){case c.mechanism.type.FLASH:c.audio.lib.preferFlash=!0;c.audio.lib.html5Only=!1;break;case c.mechanism.type.HTML5:c.audio.lib.preferFlash=!1;c.audio.lib.html5Only=!0;break;default:return b.log("Audio.reset() no playback solution exists.",b.type.error),c.events.trigger(c.events.type.PLAYER_FAILURE,null),!1}c.audio.lib.reboot();
return!0},load:function(a){if(!0===this.init_status)try{var e;switch(c.mechanism.getCurrentSolution()){case c.mechanism.type.FLASH:e={id:a.identifier,url:a.http_file_path,bufferTime:a.buffer_time,onconnect:function(){b.log("Audio.load.lib.createSound.onConnect() - successfully connected over RTMP ("+a.flash_server_url+")",b.type.info);c.internal_events.trigger(c.events.type.MEDIA_READY,a)},onfailure:function(a){var f=c.current_playable;0<f.position?(b.log("Audio.load.createSound.onfailure() -- network connection has been lost",
b.type.info),c.state.set(c.state.type.STOPPED,f),c.events.trigger(c.events.type.CONNECTION_LOST,f)):!0===a.connected?(b.log("Audio.load.createSound.onfailure() - requested file '"+f.flash_file_path+"' w/ identifier '"+f.identifier+"' could not be found in flash/RTMP mode.",b.type.error),c.state.set(c.state.type.STOPPED,f),c.events.trigger(c.events.type.MISSING_FILE,f),c.events.trigger(c.events.type.FINISHED,f)):(b.log("Audio.load.createSound.onfailure() - could not connect to '"+f.flash_server_url+
"' ... falling back to HTML5-mode.",b.type.error),c.state.set(c.state.type.STOPPED,f),c.mechanism.removeCurrentSolution(),c.audio.reset())},onload:function(a){!1===a&&(a=c.current_playable,c.events.trigger(c.events.type.MISSING_FILE,a),b.log("Audio.load.createSound.onload() - could not load '"+a.http_file_path+"' over progressive download",b.type.error))}};null!==a.flash_file_path&&""!==a.flash_file_path&&null!==a.flash_server_url&&""!==a.flash_server_url&&(e.serverURL=a.flash_server_url,e.url=a.flash_file_path);
this.lib.createSound(e);break;case c.mechanism.type.HTML5:e=this.lib.createSound({id:a.identifier,url:a.http_file_path,onload:function(a){var f=c.current_playable;a?this.duration?(f.duration=this.duration,b.log("Audio.load.createSound.onload(): duration found after start",b.type.info)):b.log("Audio.load.createSound.onload(): duration unknown",b.type.info):(c.state.set(c.state.type.STOPPED,f),c.events.trigger(c.events.type.MISSING_FILE,f),c.events.trigger(c.events.type.FINISHED,f),b.log("Audio.load.createSound.onload():  requested file '"+
f.http_file_path+"' w/ identifier '"+f.identifier+"' could not be found in HTML5 mode.",b.type.error))}});c.internal_events.trigger(c.events.type.MEDIA_READY,a);break;default:b.log("Audio.load() no playback solution exists.",b.type.error),c.events.trigger(c.events.type.PLAYER_FAILURE,a)}}catch(d){b.log("Exception thrown in APMPlayer.Audio.load : "+d.toString(),b.type.error)}else null===c.mechanism.getCurrentSolution()?c.events.trigger(c.events.type.PLAYER_FAILURE,a):b.log("Audio.lib.load - audio lib not initialized.  load() will be called again when player is finally initialized.",
b.type.info)},unload:function(a){null!==c.current_playable&&(b.log("Audio.unload() about to stop, drop and roll current sound.",b.type.info),this.lib.destroySound(a.identifier),a.reset(),c.state.set(c.state.type.STOPPED,a),c.events.trigger(c.events.type.UNLOADED,a))},play:function(a){this.lib.getSoundById(a.identifier)?(b.log("Audio.play() attempting to play from lib.",b.type.info),this.lib.play(a.identifier,{volume:100*c.settings.volume,position:a.position,onplay:function(){c.state.set(c.state.type.PLAYING,
a);c.events.trigger(c.events.type.PLAYING,a);c.events.trigger(c.events.type.METADATA,a);c.settings.muted&&this.mute();b.log("Audio.play.onplay() PLAYING fired",b.type.info)},onpause:function(){c.state.set(c.state.type.PAUSED,a);c.events.trigger(c.events.type.PAUSED,a);b.log("Audio.play.onpause() PAUSED fired",b.type.info)},onresume:function(){c.state.set(c.state.type.PLAYING,a);c.events.trigger(c.events.type.PLAYING,a);b.log("Audio.play.onresume() PLAYING fired",b.type.info)},onfinish:function(){c.current_playable.reset();
c.state.set(c.state.type.STOPPED,a);c.events.trigger(c.events.type.FINISHED,a);b.log("Audio.play.onfinish() FINISHED fired; playable reset.",b.type.info)},onbufferchange:function(){!0===this.isBuffering?(c.events.trigger(c.events.type.BUFFER_START,a),b.log("Audio.play.onbufferchange() BUFFER_START fired ",b.type.info)):(c.events.trigger(c.events.type.BUFFER_END,a),b.log("Audio.play.onbufferchange() BUFFER_END fired ",b.type.info))},whileplaying:function(){var a=c.current_playable;a.type===d.type.LIVE_AUDIO?
(a.percent_played=1,a.duration=0,a.position=this.position,c.events.trigger(c.events.type.POSITION_UPDATE,a)):(0!==this.position&&(a.position=this.position),0!==this.duration&&this.duration>a.duration&&(a.duration=this.duration),0!==this.duration&&this.duration==this.durationEstimate&&(a.duration=this.duration),this.durationEstimate>this.duration?a.percent_loaded=this.duration/this.durationEstimate:0<a.percent_loaded&&1>a.percent_loaded&&(a.percent_loaded=1),0<a.duration&&(a.percent_played=a.position/
a.duration),a.isEOF()?(a.percent_played=1,a.position=a.duration):c.events.trigger(c.events.type.POSITION_UPDATE,a))},onmetadata:function(){this.hasOwnProperty("metadata")&&(this.metadata.hasOwnProperty("adw_ad")&&"true"===this.metadata.adw_ad&&this.metadata.hasOwnProperty("metadata")&&-1!==this.metadata.metadata.indexOf("adswizzContext")?(b.log("onmetadata() received adw_ad of insertionType: '"+this.metadata.insertionType+"'",b.type.info),a.title="adw_ad_"+this.metadata.insertionType,a.adw_context=
this.metadata.metadata.substr(15),c.events.trigger(c.events.type.METADATA,a)):this.metadata.hasOwnProperty("StreamTitle")&&"undefined"!==typeof this.metadata.StreamTitle&&(b.log("onmetadata() received metadata w/ title: '"+this.metadata.StreamTitle+"'",b.type.info),a.title=this.metadata.StreamTitle,c.events.trigger(c.events.type.METADATA,a)))}})):this.load(a)},pause:function(a){var c=this.lib.getSoundById(a.identifier);if(c)return c.pause(),!0;b.log("Audio.pause() Error.  Could not pause.  '"+a.identifier+
"' is unknown.",b.type.warn);return!1},unpause:function(a){var c=this.lib.getSoundById(a.identifier);if(c&&!0===c.paused)return c.resume(),!0;b.log("Audio.unpause() Error.  Could not unpause.  '"+a.identifier+"' is unknown.",b.type.warn);return!1},seek:function(a,c){var e=this.lib.getSoundById(a.identifier);if(e){if(a.duration)return b.log("Audio.seek() seeking to '"+c+"' of sound '"+a.identifier+"'",b.type.info),e.setPosition(c*a.duration),!0;b.log("Audio.seek() Error.  Could not seek. duration of '"+
a.identifier+"' is unknown.",b.type.warn);return!1}b.log("Audio.seek() sound '"+a.identifier+"' is unknown.",b.type.warn);return!1},mute:function(a){(a=this.lib.getSoundById(a.identifier))&&a.mute()},unmute:function(a){(a=this.lib.getSoundById(a.identifier))&&a.unmute()},setVolume:function(a,c){var e=100*c,d=this.lib.getSoundById(a.identifier);d?(b.log("Audio.setVolume() setting volume to "+e+"% (out of 100)",b.type.info),d.setVolume(e)):b.log("Audio.setVolume() sound is not loaded.  volume will be set to "+
e+"% once audio begins playing",b.type.info)}};this.settings={volume:0.9,muted:!1,debug:!1};this.current_playable=null;this.events=new h;this.internal_events=new h;this.mechanism=new a;this.state=new l;this.audio=new e;this.internal_event_handlers={checkReady:function(){!0===c.audio.init_status?(b.log("checkReady() player ready.  all dependencies loaded.",b.type.info),c.events.trigger(c.events.type.PLAYER_READY,{})):b.log("checkReady() not quite ready -- waiting for other dependencies to load...",
b.type.info)},onMediaReady:function(a){c.audio.play(a)}};this.internal_events.addListener(c.events.type.AUDIO_LIB_READY,c.internal_event_handlers.checkReady);this.internal_events.addListener(c.events.type.MEDIA_READY,c.internal_event_handlers.onMediaReady);this.util={getParameterByName:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.href);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))},getLoadedScriptPathByFileName:function(a){var c=
document.getElementsByTagName("script"),b=c.length,e;for(e=0;e<b;e+=1){var d=c[e].src.indexOf(a,0);if(-1!==d)return c[e].src.slice(0,d)}return!1},getProjectBasePath:function(){var a=c.util.getLoadedScriptPathByFileName("script/apmplayer-all.min.js");"undefined"===typeof a&&(a=c.util.getLoadedScriptPathByFileName("script/apmplayer.js"));return a},mergeSettings:function(a){for(var b in a)a.hasOwnProperty(b)&&c.settings.hasOwnProperty(b)&&(c.settings[b]=a[b])},checkDebug:function(){c.util.getParameterByName("debug")&&
(b.enabled=!0);"all"===c.util.getParameterByName("debug")&&(b.consoleOnly=!1)},addIEFixes:function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,c){var b=this.length>>>0,e=Number(c)||0,e=0>e?Math.ceil(e):Math.floor(e);for(0>e&&(e+=b);e<b;e++)if(e in this&&this[e]===a)return e;return-1})}};return{init:function(a){c.util.addIEFixes();c.util.checkDebug();c.audio.init(a)},reset:function(a){a instanceof Array&&c.mechanism.setSolutions(a);c.audio.reset()},play:function(a,e){if(a instanceof
k){if(a===c.current_playable&&c.state.current()!==c.state.type.PLAYING)switch(a.type){case d.type.AUDIO:case d.type.LIVE_AUDIO:c.audio.play(a);break;case d.type.VIDEO:break;default:b.log("play() unsupported type: '"+a.type+"'",b.type.error)}else if(a!==c.current_playable){if(null===c.mechanism.getCurrentSolution())return b.log("play()  insufficient playback mechanism for platform.  Triggered PLAYER_FAILURE",b.type.error),c.events.trigger(c.events.type.PLAYER_FAILURE,a),!1;null!==c.current_playable&&
c.audio.unload(c.current_playable);c.util.mergeSettings(e);c.current_playable=a;switch(a.type){case d.type.AUDIO:case d.type.LIVE_AUDIO:c.audio.load(a);break;case d.type.VIDEO:break;default:b.log("load() unsupported type: '"+a.type+"'",b.type.error)}}return!0}b.log("play() invalid playable passed.  must of of type Playable.  did nothing.",b.type.error);return!1},pause:function(){var a=c.current_playable;if(null!==a)switch(a.type){case d.type.AUDIO:c.audio.pause(a);break;case d.type.LIVE_AUDIO:c.audio.unload(a);
break;case d.type.VIDEO:break;default:b.log("pause() unsupported type: '"+a.type+"'",b.type.error)}else b.log("pause() no current playable loaded.  nothing to pause.",b.type.warn)},unload:function(){var a=c.current_playable;if(null!==a)switch(a.type){case d.type.AUDIO:case d.type.LIVE_AUDIO:c.audio.unload(a);break;case d.type.VIDEO:break;default:b.log("unload() unsupported type: '"+a.type+"'",b.type.error)}else b.log("unload() no current playable loaded.  nothing to stop/unload.",b.type.info)},seek:function(a){var e=
c.current_playable;if(null!==e)switch(e.type){case d.type.AUDIO:c.audio.seek(e,a);break;case d.type.LIVE_AUDIO:b.log("seek() sorry, this item is not seekable '"+e.identifier+"', type: '"+e.type+"'",b.type.info);break;case d.type.VIDEO:break;default:b.log("seek() unsupported type: '"+e.type+"'",b.type.error)}else b.log("seek() no current playable loaded.  nothing to seek.",b.type.info)},mute:function(){c.settings.muted=!0;var a=c.current_playable;if(null!==a)switch(a.type){case d.type.AUDIO:case d.type.LIVE_AUDIO:c.audio.mute(a);
break;case d.type.VIDEO:break;default:b.log("mute() unsupported type: '"+a.type+"'",b.type.error)}b.log("mute() -- player is now muted.",b.type.info)},unmute:function(){c.settings.muted=!1;var a=c.current_playable;if(null!==a)switch(a.type){case d.type.AUDIO:case d.type.LIVE_AUDIO:c.audio.unmute(a);break;case d.type.VIDEO:break;default:b.log("unmute() unsupported type: '"+a.type+"'",b.type.error)}b.log("unmute() -- player is now unmuted.",b.type.info)},setVolume:function(a){0>a?(a=0,b.log("setVolume() invalid percent_decimal passed: '"+
a+"' is less than 0.  percent_decimal set to 0.  percentages must be represented as a decimal from 0 to 1 (eg .45)",b.type.warn)):1<a&&(a=1,b.log("setVolume() invalid percent_decimal passed: '"+a+"' is greater than 1.  percent_decimal set to 1.00 by default.  percentages must be represented as a decimal from 0.00 to 1.00 (eg .45)",b.type.warn));var e=c.current_playable;if(null!==e)switch(e.type){case d.type.AUDIO:case d.type.LIVE_AUDIO:c.audio.setVolume(e,a);break;case d.type.VIDEO:break;default:b.log("setVolume() unsupported type: '"+
e.type+"'",b.type.error)}else b.log("setVolume() no playable loaded.  VOLUME_UPDATED event still fired. new vox : '"+a+"'",b.type.info);c.settings.volume=a;c.events.trigger(c.events.type.VOLUME_UPDATED,{percent_decimal:a})},debug:b,events:c.events,mechanism:c.mechanism,mediaTypes:d.type,state:c.state,base_path:c.util.getProjectBasePath()}},p=function(){this.events=new h;this._items=[];this._current_index=null};p.prototype={add:function(a){if(a instanceof k&&a.isValid()){if(null!==this.item(a.identifier))return b.log("add() could not add '"+
a.identifier+"' to playlist because it already exists!",b.type.warn,"Playlist"),!1;this._items.push(a);null===this._current_index&&(this._current_index=0,this.events.trigger(this.events.type.PLAYLIST_CURRENT_CHANGE,null));b.log("add() new playable successfully added to playlist: '"+a.identifier+"'",b.type.info,"Playlist");return!0}b.log("add() -- error: nothing added to playlist.  either object passed was not of type Playable or identifier '"+a.identifier+"' is invalid.",b.type.warn,"Playlist");return!1},
_count:function(){return this._items.length},current:function(){return null!==this._current_index?this._items[this._current_index]:null},item:function(a){var b,e=this._count();for(b=0;b<e;b+=1)if(this._items[b].identifier===a)return this._items[b];return null},"goto":function(a){var e,d=this._count();for(e=0;e<d;e+=1)if(this._items[e].identifier===a)return a=this.current(),this._current_index=e,this.events.trigger(this.events.type.PLAYLIST_CURRENT_CHANGE,a),!0;b.log("goto() - invalid identifier passed '"+
a+"'.  This was not found in the current playlist!",b.type.warn,"Playlist");return!1},hasNext:function(){return this._current_index+1<this._count()?!0:!1},remove:function(a){var e,d=this._count();for(e=0;e<d;e+=1)if(this._items[e].identifier===a){if(this.current().identifier===a){b.log("remove() -- sorry, you may not remove the current item in the playlist. returning false.)",b.type.warn,"Playlist");break}this._items.splice(e,1);0<this._current_index&&e<=this._current_index&&(this._current_index-=
1);return!0}return!1},next:function(){if(null!==this._current_index){b.log("next() advancing to next position in playlist (or to beginning if at last)",b.type.info,"Playlist");var a=this.current();this._current_index=this._current_index+1<this._count()?this._current_index+1:0;this.events.trigger(this.events.type.PLAYLIST_CURRENT_CHANGE,a)}else return!1},previous:function(){if(null!==this._current_index){b.log("previous() moving to previous position in playlist (or to last if at beginning)",b.type.info,
"Playlist");var a=this.current();this._current_index=0<=this._current_index-1?this._current_index-1:this._count()-1;this.events.trigger(this.events.type.PLAYLIST_CURRENT_CHANGE,a)}else return!1}};var m;return{getPlayer:function(){"undefined"===typeof m&&(m=new q,m.constructor=null);return m},getPlayable:function(a){return new k(a)},getPlaylist:function(){return new p},getUnderwritingPlayable:function(a){return new n(a)},getCustomSchemes:function(){return g}}}();
var scheme_map={apm_audio:{flash_server_url:"rtmp://ondemand-rtmp.stream.publicradio.org/music",flash_file_prefix:"mp3:ondemand",http_file_prefix:"http://ondemand-http.stream.publicradio.org",buffer_time:3,type:"audio"},apm_live_audio:{mpr_news:{flash_server_url:"rtmp://wowza.stream.publicradio.org/news",flash_file_path:"news.stream",http_file_path:"http://nis.stream.publicradio.org/nis.mp3",buffer_time:6,type:"live_audio"},mpr_current:{flash_server_url:"rtmp://wowza.stream.publicradio.org/kcmp",
flash_file_path:"kcmp.stream",http_file_path:"http://current.stream.publicradio.org/kcmp.mp3",buffer_time:6,type:"live_audio"},csf:{flash_server_url:"rtmp://wowza.stream.publicradio.org/csf",flash_file_path:"csf.stream",http_file_path:"http://csf.stream.publicradio.org/csf.mp3",buffer_time:6,type:"live_audio"},wpbi:{flash_server_url:"rtmp://wowza.stream.publicradio.org/wpbistream",flash_file_path:"wpbi.stream",http_file_path:"http://wpbi.stream.publicradio.org/wpbi.mp3",buffer_time:6,type:"live_audio"},
mpr_local_current:{flash_server_url:"rtmp://wowza.stream.publicradio.org/localstream",flash_file_path:"local.stream",http_file_path:"http://localcurrent.stream.publicradio.org/localcurrent.mp3",buffer_time:6,type:"live_audio"},mpr_wonderground:{flash_server_url:"rtmp://wowza.stream.publicradio.org/wonderground",flash_file_path:"wonderground.stream",http_file_path:"http://wonderground.stream.publicradio.org/wonderground.mp3",buffer_time:6,type:"live_audio"},mpr_radio_heartland:{flash_server_url:"rtmp://wowza.stream.publicradio.org/radioheartland",
flash_file_path:"radioheartland.stream",http_file_path:"http://radioheartland.stream.publicradio.org/radioheartland.mp3",buffer_time:6,type:"live_audio"},mpr_classical:{flash_server_url:"rtmp://wowza.stream.publicradio.org/ksjn",flash_file_path:"ksjn.stream",http_file_path:"http://cms.stream.publicradio.org/cms.mp3",buffer_time:6,type:"live_audio"},mpr_classical_choral:{flash_server_url:"rtmp://wowza.stream.publicradio.org/choral",flash_file_path:"choral.stream",http_file_path:"http://choral.stream.publicradio.org/choral.mp3",
buffer_time:6,type:"live_audio"},utility:{flash_server_url:"rtmp://wowza.stream.publicradio.org/utility",flash_file_path:"utility.stream",http_file_path:"http://utility.stream.publicradio.org/utility01.mp3",buffer_time:6,type:"live_audio"},utility2:{flash_server_url:"rtmp://wowza.stream.publicradio.org/utility2",flash_file_path:"utility2.stream",http_file_path:"http://utility.stream.publicradio.org/utility02.mp3",buffer_time:6,type:"live_audio"},utility3:{flash_server_url:"rtmp://wowza.stream.publicradio.org/utility3",
flash_file_path:"utility3.stream",http_file_path:"http://utility.stream.publicradio.org/utility03.mp3",buffer_time:6,type:"live_audio"},utility4:{flash_server_url:"rtmp://wowza.stream.publicradio.org/utility4",flash_file_path:"utility4.stream",http_file_path:"http://utility.stream.publicradio.org/utility04.mp3",buffer_time:6,type:"live_audio"},c24:{flash_server_url:"rtmp://wowza.stream.publicradio.org/c24",flash_file_path:"c24.stream",http_file_path:"http://c24.stream.publicradio.org/c24.mp3",buffer_time:6,
type:"live_audio"}}},custom_schemes=APMPlayerFactory.getCustomSchemes();custom_schemes.init(scheme_map);var APMPlayer=APMPlayerFactory.getPlayer();APMPlayer.init();
(function(d){var b=function(b,l){var a=this;this.parent_id="#"+b.attr("id");this.args=l;this.init=function(){a.main.init();a.controls.init();a.events.init();a.underwriting.init();a.playlist.init()};this.main={settings:{autoplay:!1,muted:!1,fetchMetadata:!0,volume:0.9,autoAdvance:!0,timeDisplay:"full"},isReady:!1,init:function(){a.args.hasOwnProperty("settings")&&a.main.mergeSettings(a.args.settings);!0===a.main.settings.autoplay&&!0===a.main.settings.fetchMetadata&&(a.main.settings.autoplay="wait")},
mergeSettings:function(e){for(var b in e)e.hasOwnProperty(b)&&a.main.settings.hasOwnProperty(b)&&(a.main.settings[b]=e[b])},canAutoPlay:function(){return!0===a.main.settings.autoplay&&APMPlayer.mechanism.getCurrentSolution()!==APMPlayer.mechanism.type.HTML5&&!0===a.main.isReady?!0:!1},updateAutoPlay:function(b){a.playlist.current().identifier===b.identifier&&"wait"===a.main.settings.autoplay&&(a.main.settings.autoplay=!0)},play:function(){a.underwriting.needsRender()?a.underwriting.renderAd():APMPlayer.play(a.playlist.current(),
a.main.settings)},fetchMetadata:function(b){d.getJSON("http://www.publicradio.org/tools/api/audio/metadata/?callback=?","id="+b.identifier,a.events.onFetchMetadata)}};this.skin={css:{play:"apm_player_play",pause:"apm_player_pause",seeker:"apm_player_bar",seekerBufferingCls:"buffering",seekerLoading:"apm_player_loading",liveStreamingCls:"streaming",volumeWrapper:"apm_player_volume_wrapper",volumeMutedCls:"muted",volumeBar:"apm_volume_bar",volumeBarWrapper:"apm_player_volume_slider_wrapper",volumeStatus:"apm_player_volume_status",
info:"apm_player_info",status:"apm_player_status",statusWarningCls:"warning",statusAlertCls:"alert",playtime:"apm_player_playtime",playlist:"apm_playlist",playlistNowPlayingCls:"nowplaying",sponsorOverlayActiveCls:"preroll-active",sponsorOverlayInactiveCls:"preroll-inactive",sponsorTimer:"apm_sponsor_overlay_time",sharingTools:"apm_sharing_tools",sharingTabControls:"apm_sharing_tab_controls",sharingTabCls:"apm_sharing_tab",sharingTabSharing:"apm_sharing_share",sharingTabDownload:"apm_sharing_download",
sharingTabEmbed:"apm_sharing_embed",sharingTabLink:"apm_sharing_link"}};this.controls={init:function(){a.controls.seeker.init();a.controls.info.init();a.controls.volume.init();a.controls.volumeStatus.init();a.controls.pause.init();a.controls.play.init();a.controls.tools.init()},play:{init:function(){d(a.parent_id+" #"+a.skin.css.play).click(function(){a.main.play()})}},pause:{init:function(){d(a.parent_id+" #"+a.skin.css.pause).click(function(){APMPlayer.pause()})}},seeker:"function"===typeof d(a.parent_id+
" #"+a.skin.css.seeker).slider?{status:"NORMAL",init:function(){d(a.parent_id+" #"+a.skin.css.seeker).slider({disabled:!0,range:"min",start:function(b,d){a.controls.seeker.status="USER_SLIDING"},stop:function(b,d){a.events.onSeek(d.value/100);a.controls.seeker.status="NORMAL"},slide:function(b,d){a.controls.seeker.status="USER_SLIDING";var k=a.playlist.current();k.position=d.value/100*k.duration;a.controls.playtime.render(k)}})},update:function(b){if("NORMAL"===a.controls.seeker.status){var g=100*
b.percent_played;d(a.parent_id+" #"+a.skin.css.seeker).slider("value",g)}1>=b.percent_loaded&&(b=100*b.percent_loaded,d(a.parent_id+" #"+a.skin.css.seekerLoading).width(b+"%"))},enable:function(){a.playlist.current().type!==APMPlayer.mediaTypes.LIVE_AUDIO&&d(a.parent_id+" #"+a.skin.css.seeker).slider("enable")},disable:function(){a.playlist.current().type===APMPlayer.mediaTypes.LIVE_AUDIO&&d(a.parent_id+" #"+a.skin.css.seeker).slider("disable")},reset:function(){d(a.parent_id+" #"+a.skin.css.seeker).slider("value",
0)},configure:function(b){a.controls.seeker.reset();b.type===APMPlayer.mediaTypes.LIVE_AUDIO?(a.controls.seeker.disable(),d(a.parent_id+" #"+a.skin.css.seeker).addClass(a.skin.css.liveStreamingCls)):(0<b.duration&&a.controls.seeker.enable(),d(a.parent_id+" #"+a.skin.css.seeker).removeClass(a.skin.css.liveStreamingCls))}}:{status:"NORMAL",init:function(){},update:function(a){},enable:function(){},disable:function(){},reset:function(){},configure:function(a){}},playtime:{convertToTime:function(a){var b=
new Date(a);a=b.getUTCHours();var d=b.getUTCMinutes(),b=b.getUTCSeconds();return(0<a?a+":":"")+((0<a&&10>d?"0"+d:d)+":")+(10>b?"0"+b:b)},timeDisplay:{countdown_text:function(b,d){return 0<d?a.controls.playtime.convertToTime(d-b)+" remaining":a.controls.playtime.convertToTime(b)+" played"},countdown:function(b,d){return 0<d?a.controls.playtime.convertToTime(d-b):0},full:function(b,d){return 0<d?a.controls.playtime.convertToTime(b)+" / "+a.controls.playtime.convertToTime(d):a.controls.playtime.convertToTime(b)},
position:function(b,d){return a.controls.playtime.convertToTime(b)}},render:function(b){if("undefined"!==typeof b.is_underwriting)a.underwriting.renderTime(b);else{var g;"function"===typeof a.main.settings.timeDisplay?g=a.main.settings.timeDisplay(b.position,b.duration):a.controls.playtime.timeDisplay.hasOwnProperty(a.main.settings.timeDisplay)?g=a.controls.playtime.timeDisplay[a.main.settings.timeDisplay](b.position,b.duration):APMPlayer.debug.log("playtime.convertToTime() setting timeDisplay is not a valid option or callback.",
APMPlayer.debug.type.error,"APMPlayerUI");d(a.parent_id+" #"+a.skin.css.playtime).text(g)}}},volume:"function"===typeof d(a.parent_id+" #"+a.skin.css.volumeBar).slider?{init:function(){d(a.parent_id+" #"+a.skin.css.volumeBar).slider({range:"min",orientation:"vertical",value:100*a.main.settings.volume,stop:function(b,d){APMPlayer.setVolume(d.value/100);0<d.value&&a.main.settings.muted&&(APMPlayer.unmute(),a.controls.volumeStatus.renderUnmuted(),a.main.settings.muted=!1)}});d(a.parent_id+" #"+a.skin.css.volumeWrapper).hover(function(){d(a.parent_id+
" #"+a.skin.css.volumeBarWrapper).show()},function(){d(a.parent_id+" #"+a.skin.css.volumeBarWrapper).fadeOut(500)})},renderMuted:function(){d(a.parent_id+" #"+a.skin.css.volumeBar).slider("value",0)},renderUnmuted:function(){d(a.parent_id+" #"+a.skin.css.volumeBar).slider("value",100*a.main.settings.volume)}}:{init:function(){},renderMuted:function(){},renderUnmuted:function(){}},volumeStatus:{init:function(){d(a.parent_id+" #"+a.skin.css.volumeStatus).click(function(){a.main.settings.muted?(APMPlayer.unmute(),
a.main.settings.muted=!1,a.controls.volume.renderUnmuted(),a.controls.volumeStatus.renderUnmuted()):(APMPlayer.mute(),a.main.settings.muted=!0,a.controls.volume.renderMuted(),a.controls.volumeStatus.renderMuted())})},renderMuted:function(){d(a.parent_id+" #"+a.skin.css.volumeStatus).addClass(a.skin.css.volumeMutedCls)},renderUnmuted:function(){d(a.parent_id+" #"+a.skin.css.volumeStatus).removeClass(a.skin.css.volumeMutedCls)}},info:{init:function(){a.args.hasOwnProperty("onMetadata")&&(a.events.onMetadata=
a.args.onMetadata)}},status:{displayWarning:function(b){d(a.parent_id+" #"+a.skin.css.status).html(b);d(a.parent_id+" #"+a.skin.css.status).addClass(a.skin.css.statusWarningCls)},displayAlert:function(b){d(a.parent_id+" #"+a.skin.css.status).html(b);d(a.parent_id+" #"+a.skin.css.status).addClass(a.skin.css.statusAlertCls)},clearAll:function(){d(a.parent_id+" #"+a.skin.css.status).removeClass(a.skin.css.statusAlertCls);d(a.parent_id+" #"+a.skin.css.status).removeClass(a.skin.css.statusWarningCls);
d(a.parent_id+" #"+a.skin.css.status).html("")}},tools:{init:function(){a.args.hasOwnProperty("tools")&&a.args.tools.hasOwnProperty("config")&&(a.controls.tools.config=a.args.tools.config);a.controls.tools.config()},config:function(){d(a.parent_id+" #"+a.skin.css.sharingTools+" ."+a.skin.css.sharingTabCls).hide();d(a.parent_id+" #"+a.skin.css.sharingTools+" ."+a.skin.css.sharingTabCls+":first").show();d(a.parent_id+" #"+a.skin.css.sharingTools+" ul#"+a.skin.css.sharingTabControls+" li:first").addClass("active");
d(a.parent_id+" #"+a.skin.css.sharingTools+" ul#"+a.skin.css.sharingTabControls+" li a").click(function(){d(a.parent_id+" #"+a.skin.css.sharingTools+" ul#"+a.skin.css.sharingTabControls+" li").removeClass("active");d(this).parent().addClass("active");var b=d(this).attr("href");d(a.parent_id+" #"+a.skin.css.sharingTools+" ."+a.skin.css.sharingTabCls).hide();d(b).show();return!1})},renderDownload:function(b){var g="",g=!0===b.downloadable&&a.playlist.current().type===APMPlayer.mediaTypes.AUDIO?'<a href="'+
APMPlayer.base_path+"util/download.php?uri="+b.http_file_path+'">file download</a>':"sorry, this item is not downloadable.";d(a.parent_id+" #"+a.skin.css.sharingTools+" #"+a.skin.css.sharingTabDownload).html(g)}}};this.events={init:function(){APMPlayer.events.addListener(APMPlayer.events.type.PLAYER_READY,a.events.onPlayerReady);APMPlayer.events.addListener(APMPlayer.events.type.PLAYING,a.events.onPlaying);APMPlayer.events.addListener(APMPlayer.events.type.PAUSED,a.events.onPaused);APMPlayer.events.addListener(APMPlayer.events.type.METADATA,
a.events.onMetadata);APMPlayer.events.addListener(APMPlayer.events.type.BUFFER_START,a.events.onBufferStart);APMPlayer.events.addListener(APMPlayer.events.type.BUFFER_END,a.events.onBufferEnd);APMPlayer.events.addListener(APMPlayer.events.type.POSITION_UPDATE,a.events.onPositionUpdate);APMPlayer.events.addListener(APMPlayer.events.type.FINISHED,a.events.onFinished);APMPlayer.events.addListener(APMPlayer.events.type.UNLOADED,a.events.onUnloaded);APMPlayer.events.addListener(APMPlayer.events.type.VOLUME_UPDATED,
a.events.onVolumeUpdated);APMPlayer.events.addListener(APMPlayer.events.type.CONNECTION_LOST,a.events.onConnectionLost);APMPlayer.events.addListener(APMPlayer.events.type.PLAYER_FAILURE,a.events.onFailure);APMPlayer.events.addListener(APMPlayer.events.type.MISSING_FILE,a.events.onMissingFile)},onPlayerReady:function(){a.main.isReady=!0;if(a.main.canAutoPlay())a.main.play();else{var b=a.playlist.current();if(null!==b)a.events.onMetadata(b)}},onPlaying:function(b){a.controls.seeker.enable();a.controls.status.clearAll();
d(a.parent_id+" #"+a.skin.css.play).hide();d(a.parent_id+" #"+a.skin.css.pause).show();a.playlist.addNowPlaying(b)},onPaused:function(b){d(a.parent_id+" #"+a.skin.css.play).show();d(a.parent_id+" #"+a.skin.css.pause).hide();b.type===APMPlayer.mediaTypes.LIVE_AUDIO&&a.controls.seeker.reset()},onFinished:function(){a.controls.seeker.disable();!0===a.underwriting.active?(a.controls.seeker.reset(),a.underwriting.onFinished(),a.main.play()):a.playlist.hasNext()&&a.main.settings.autoAdvance?a.playlist.next():
APMPlayer.unload()},onPositionUpdate:function(b){a.controls.seeker.update(b);"USER_SLIDING"!==a.controls.seeker.status&&a.controls.playtime.render(b)},onSeek:function(b){if(APMPlayer.state.current()!==APMPlayer.state.type.STOPPED)APMPlayer.seek(b);else{var d=a.playlist.current();0<d.duration&&(d.percent_played=b,d.position=d.duration*b,a.controls.playtime.render(d))}},onUnloaded:function(b){a.controls.seeker.reset();a.controls.playtime.render(b);d(a.parent_id+" #"+a.skin.css.play).show();d(a.parent_id+
" #"+a.skin.css.pause).hide()},onBufferStart:function(){APMPlayer.state.current()===APMPlayer.state.type.PLAYING&&d(a.parent_id+" #"+a.skin.css.seeker).addClass(a.skin.css.seekerBufferingCls)},onBufferEnd:function(){d(a.parent_id+" #"+a.skin.css.seeker).removeClass(a.skin.css.seekerBufferingCls)},onFetchMetadata:function(b){if(b.hasOwnProperty("error"))switch(b.error.code){case "1":APMPlayer.debug.log("events.onFetchMetadata() Error: '"+b.error.description+"'  id: '"+b.error.id+"'",APMPlayer.debug.type.error,
"APMPlayerUI");break;case "2":var g=a.playlist.item(b.error.identifier);g.clearFlashProperties();g.http_file_path="http://download.publicradio.org/podcast"+b.error.path;APMPlayer.debug.log("events.onFetchMetadata() No podcast or streaming record found in AudioQ for a valid identifier: '"+g.identifier+"' ... let's try to wing it anyway!  (this is going down in your permanent record)",APMPlayer.debug.type.warn,"APMPlayerUI")}else d.each(b,function(b,e){var d=a.playlist.item(b);e.hasOwnProperty("stream")?
(d.setEmptyMembers(e.stream),APMPlayer.debug.log("events.onFetchMetadata() Successfully loaded metadata for valid stream instance: '"+d.identifier+"'",APMPlayer.debug.type.info,"APMPlayerUI")):(d.clearFlashProperties(),APMPlayer.debug.log("events.onFetchMetadata() No flash streaming version found! '"+d.identifier+"'",APMPlayer.debug.type.warn,"APMPlayerUI"));e.hasOwnProperty("podcast")&&(d.setEmptyMembers(e.podcast),d.http_file_path=e.podcast.http_file_path,APMPlayer.debug.log("events.onFetchMetadata() Podcast version found, setting http_file_path for download location for '"+
d.identifier+"'",APMPlayer.debug.type.info,"APMPlayerUI"));a.playlist.onUpdate(d);var g=a.playlist.current();d.identifier===g.identifier&&(a.events.onMetadata(g),a.controls.tools.renderDownload(g),0<g.duration&&(a.controls.playtime.render(g),g.isFlashStreamable()&&(a.controls.seeker.enable(),0<g.position&&(g.percent_played=g.position/g.duration),a.controls.seeker.update(g))),a.main.updateAutoPlay(d),a.main.canAutoPlay()&&a.main.play())})},onMetadata:function(){},onFailure:function(){var b=a.playlist.current(),
d='<p>We\'re sorry, but your browser is not able to play the stream.  Please try one of these options:  <br /><br />1) Install or enable <a href="http://get.adobe.com/flashplayer/" target="_blank">Adobe Flash Player</a> <br />2) Use a browser that supports HTML5 and MP3 audio, such as <a href="http://www.google.com/chrome/" target="_blank">Chrome</a>, <a href="http://www.apple.com/safari/download/" target="_blank">Safari</a>, or <a href="http://www.microsoft.com/ie9" target="_blank">Internet Explorer 9</a>';
/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&(d='<p>We\'re sorry, but your browser is not able to play the stream.  Please try one of these options:  <br /><br />1) Install or enable <a href="http://get.adobe.com/flashplayer/" target="_blank">Adobe Flash Player</a> <br />2) Install <a href="http://www.apple.com/quicktime/download/" target="_blank">Quicktime</a> for HTML5 support for Safari on Windows (requires reboot) <br />2b) Use a different browser that natively supports HTML5 and MP3 audio, such as <a href="http://www.google.com/chrome/" target="_blank">Chrome</a> or <a href="http://www.microsoft.com/ie9" target="_blank">Internet Explorer 9</a>');
!0===b.downloadable&&""!==b.http_file_path&&(b.type===APMPlayer.mediaTypes.AUDIO?d+='<br />3) <a href="'+APMPlayer.base_path+"util/download.php?uri="+b.http_file_path+'">download the audio</a>':b.type===APMPlayer.mediaTypes.LIVE_AUDIO&&(d+='<br />3) <a href="'+b.http_file_path+'">Stream the audio using a third-party player (eg. iTunes)</a>'));a.controls.status.displayWarning(d+"</p>");a.underwriting.removeOverlay()},onVolumeUpdated:function(b){a.main.settings.volume=b.percent_decimal},onConnectionLost:function(){APMPlayer.unload();
a.controls.status.displayAlert("<p>Your network connection has changed or has been lost.<br /><br />Please check your internet connection, then click play to resume.");a.underwriting.removeOverlay()},onMissingFile:function(b){a.controls.status.displayWarning("<p>We're sorry, an error has occurred and your audio cannot be played at this time. <br /><br />Often, this error is a result of a poor or missing internet connection.  Please check your internet connection, then click play to resume.");a.underwriting.removeOverlay()}};
this.playlist=APMPlayerFactory.getPlaylist();a.playlist.onUpdate=function(a){};a.playlist.init=function(){a.args.hasOwnProperty("onPlaylistUpdate")&&(a.playlist.onUpdate=a.args.onPlaylistUpdate);a.args.hasOwnProperty("playables")&&d.each(a.args.playables,function(b,d){a.playlist.addPlayable(d)})};a.playlist.addPlayable=function(b){b=APMPlayerFactory.getPlayable(b);b.isValid()?(a.playlist.add(b),a.playlist.onUpdate(b),!0===a.main.settings.fetchMetadata&&(b.isCustomScheme("apm_audio")?a.main.fetchMetadata(b):
a.main.updateAutoPlay(b))):APMPlayer.debug.log("sorry, there was a problem with the parameters passed and a valid playable could not be created.",APMPlayer.debug.type.warn,"APMPlayerUI")};a.playlist.gotoItem=function(b){if(APMPlayer.state.current()===APMPlayer.state.type.STOPPED||a.playlist.current().identifier!==b)a.controls.seeker.disable(),a.playlist["goto"](b)};a.playlist.addNowPlaying=function(b){d("li[ id = '"+b.identifier+"']").addClass(a.skin.css.playlistNowPlayingCls)};a.playlist.removeNowPlaying=
function(b){d(a.parent_id+" #"+a.skin.css.playlist+" li[id='"+b.identifier+"']").removeClass(a.skin.css.playlistNowPlayingCls)};a.playlist.onCurrentChange=function(b){null!==b&&(a.playlist.removeNowPlaying(b),a.main.play());b=a.playlist.current();a.controls.seeker.configure(b);a.controls.tools.renderDownload(b)};a.playlist.events.addListener(APMPlayer.events.type.PLAYLIST_CURRENT_CHANGE,a.playlist.onCurrentChange);this.underwriting={playable:null,active:!1,init:function(){a.args.hasOwnProperty("underwriting")&&
d.each(a.args.underwriting,function(b,d){null===a.underwriting.playable?(a.underwriting.playable=APMPlayerFactory.getUnderwritingPlayable(d),APMPlayer.debug.log("player_ui.underwriting.init() - created underwriting object",APMPlayer.debug.type.info,"APMPlayerUI")):APMPlayer.debug.log("sorry, only one underwriting creative is currently allowed.",APMPlayer.debug.type.error,"APMPlayerUI")})},needsRender:function(){return a.underwriting.active?!0:null!==a.underwriting.playable&&!1===a.underwriting.playable.has_played&&
!0===a.underwriting.playable.isValid()?!0:!1},renderAd:function(){a.underwriting.active=!0;a.underwriting.playable.has_played=!0;a.underwriting.addOverlay();APMPlayer.play(a.underwriting.playable,a.main.settings)},renderTime:function(b){b=0<b.duration?a.controls.playtime.convertToTime(b.duration-b.duration*b.percent_played)+" remaining":"a few seconds remaining";d(a.parent_id+" #"+a.skin.css.sponsorTimer).text(b)},addOverlay:function(){d(a.parent_id).addClass(a.skin.css.sponsorOverlayActiveCls);d(a.parent_id).removeClass(a.skin.css.sponsorOverlayInactiveCls)},
removeOverlay:function(){d(a.parent_id).addClass(a.skin.css.sponsorOverlayInactiveCls);d(a.parent_id).removeClass(a.skin.css.sponsorOverlayActiveCls)},onFinished:function(){a.underwriting.active=!1;a.underwriting.removeOverlay()}};a.init()};d.fn.apmplayer_ui=function(h){if("undefined"===typeof APMPlayer||"undefined"===typeof soundManager)return d.error("apmplayer_ui ERROR.  1 or more dependent libraries missing.  exiting."),null;var l={addPlayable:function(a){"undefined"!==typeof window.apmplayer_ui?
window.apmplayer_ui.playlist.addPlayable(a):APMPlayer.debug.log("you must first initialize apmplayer_ui before calling methods on it.",APMPlayer.debug.type.error,"APMPlayerUI")},gotoPlaylistItem:function(a){"undefined"!==typeof window.apmplayer_ui?window.apmplayer_ui.playlist.gotoItem(a):APMPlayer.debug.log("you must first initialize apmplayer_ui before calling methods on it.",APMPlayer.debug.type.error,"APMPlayerUI")}};if(l[h])return l[h].apply(this,Array.prototype.slice.call(arguments,1));"object"!==
typeof h&&h?APMPlayer.debug.log("Method "+h+" does not exist on jQuery.apmplayer_ui",APMPlayer.debug.type.error,"APMPlayerUI"):"undefined"===typeof window.apmplayer_ui?(window.apmplayer_ui=new b(this,h),APMPlayer.debug.log("instantiated apmplayer_ui",APMPlayer.debug.type.info,"APMPlayerUI")):APMPlayer.debug.log("sorry, only one player UI instance is currently supported.",APMPlayer.debug.type.error,"APMPlayerUI")}})(jQuery);
